

# Breadcrumbs вшитые в фильтры (с UX-улучшениями)

## Основной план (без изменений)

Кнопки фильтров "Юниты" и "Команды" визуально отражают текущий уровень зума в тримапе без пересборки данных. Отдельный блок breadcrumbs удаляется.

## UX-улучшения поверх базового плана

### 1. Визуальное отличие zoom-контекста от ручного фильтра

Когда кнопка показывает zoom-позицию (а не ручной выбор пользователя), она должна выглядеть иначе -- чтобы пользователь понимал, что это "где я нахожусь", а не "что я отфильтровал". Предлагаю:

- **Ручной фильтр** (текущее поведение): кнопка с `bg-primary/10 border-primary/30` -- яркий акцент
- **Zoom-контекст**: кнопка с `border-dashed border-muted-foreground/40` и текст чуть приглушённый (`text-foreground/70`) -- визуально "мягче", как подсказка

Это тонкое, но важное различие: пользователь интуитивно понимает, что dashed border = автоматическая подсказка, а solid + цвет = его выбор.

### 2. Клик по zoom-кнопке открывает дропдаун как обычно

Если пользователь видит "Tech Platform" в кнопке юнитов (из-за зума) и кликает на неё -- открывается обычный дропдаун со всеми юнитами. Ничего не предвыбрано (потому что реально фильтр пуст). Это позволяет в любой момент переключиться с зума на ручной фильтр.

### 3. Стейкхолдеры на вкладке Stakeholders

На вкладке стейкхолдеров `zoomPath[0]` -- это стейкхолдер, не юнит. Нужно учесть это и показывать zoom-контекст в кнопке "Стейкх." когда активна вкладка стейкхолдеров. Для этого потребуется передать информацию о текущей вкладке или типе тримапа.

## Поведение (уточненное)

```text
Тримап бюджетов:
  Zoom в юнит "Tech Platform":
    Кнопка юнитов: "Tech Platform" (dashed border, приглушённый)
    Кнопка команд: "Команды" (без изменений)

  Zoom в команду "Backend":
    Кнопка юнитов: "Tech Platform" (dashed)
    Кнопка команд: "Backend" (dashed)

  Zoom out полностью:
    Кнопка юнитов: "Юниты" (обычная)
    Кнопка команд: "Команды" (обычная)

Тримап стейкхолдеров:
  Zoom в стейкхолдера "VP Product":
    Кнопка стейкхолдеров: "VP Product" (dashed)
    
  Zoom глубже в юнит:
    Кнопка стейкхолдеров: "VP Product" (dashed)
    Кнопка юнитов: "Unit Name" (dashed)

Ручной клик по фильтру:
  Zoom сбрасывается
  Кнопка показывает выбранное значение (solid border, яркий)
```

## Технические изменения

### 1. `src/components/FilterBar.tsx`

- Удалить блок breadcrumb (строки 362-373)
- Добавить проп `zoomActiveTab?: 'budget' | 'stakeholders'` для понимания, что означает zoomPath[0]
- Обновить `getUnitLabel()`:
  - Если `selectedUnits` пуст и `zoomActiveTab === 'budget'` и `zoomPath[0]` существует -- вернуть `zoomPath[0]`
  - Если `selectedUnits` пуст и `zoomActiveTab === 'stakeholders'` и `zoomPath[1]` существует -- вернуть `zoomPath[1]`
- Обновить `getTeamLabel()`:
  - Аналогичная логика со сдвигом на 1 уровень для стейкхолдеров
- Обновить `getStakeholderLabel()`:
  - Если `selectedStakeholders` пуст и `zoomActiveTab === 'stakeholders'` и `zoomPath[0]` существует -- вернуть `zoomPath[0]`
- Добавить вспомогательную функцию `isZoomContext(filterType)` -- возвращает true, если кнопка показывает zoom-путь, а не ручной фильтр
- Применить стиль `border-dashed border-muted-foreground/40 text-foreground/70` к кнопкам в zoom-контексте

### 2. `src/pages/Index.tsx`

- При ручном изменении фильтров: инкрементировать `resetZoomTrigger` и очистить `zoomPath`
- Передать `zoomPath` и текущую вкладку в FilterBar
- Передать `resetZoomTrigger` в BudgetTreemap/StakeholdersTreemap

### 3. `src/components/treemap/TreemapContainer.tsx`

- Принять проп `resetZoomTrigger?: number`
- При изменении `resetZoomTrigger` -- сбросить `focusedPath` в `[]`
- `onFocusedPathChange` уже есть, без дополнительных изменений

### 4. `src/components/BudgetTreemap.tsx` и `StakeholdersTreemap.tsx`

- Прокинуть `resetZoomTrigger` в TreemapContainer

## Что НЕ меняется

- Анимации zoom-in/out
- Логика фильтрации данных
- Пересборка дерева (только от ручных фильтров)
- Кнопка "Наверх"

