

# Плавный exit дочерних элементов при zoom-out

## Проблема

При zoom-out дочерние узлы одновременно:
1. Сжимаются геометрически (layout пересчитывается под новый масштаб)
2. Исчезают через fade + scale

Это создаёт эффект "схлопывания в точку" — резко и некрасиво. При zoom-in такой проблемы нет, потому что элементы появляются из маленького в большой — естественное движение.

## Решение

Разделить exit-анимацию по типу: при navigate-up дочерние элементы должны исчезать **быстрее и раньше**, чем родитель завершит сжатие. Также убрать scale из exit при zoom-out — оставить только opacity, чтобы не было двойного сжатия.

## Технические изменения

### 1. `src/components/treemap/TreemapNode.tsx`

Сделать exit-вариант зависимым от `animationType`:

- **При `navigate-up` / `navigate-up-fast`**: exit = `{ opacity: 0, transition: { duration: 0.15 } }` — только opacity, быстро (150мс). Без scale — геометрическое сжатие родителя уже обеспечивает визуальный "уход". Элементы просто растворяются, не успевая визуально сколлапсировать.
- **При остальных типах** (filter, drilldown, etc.): exit остаётся как сейчас — `{ opacity: 0, scale: 0.92, duration: 0.3 }`.

Для этого нужно превратить `variants.exit` в динамическое значение:

```text
exit: animationType включает 'navigate-up'
  → { opacity: 0, transition: { duration: 0.15 } }
  → иначе: { opacity: 0, scale: 0.92, transition: { duration: 0.3 } }
```

### 2. `src/components/treemap/TreemapContainer.tsx`

Уменьшить задержку `renderDepth` при zoom-out с 800мс до 600мс — дочерние элементы исчезают за 150мс, после чего 600мс достаточно для завершения геометрической анимации родителя (700мс). Это синхронизирует два процесса точнее.

## Что НЕ меняется

- Анимация zoom-in (drilldown)
- Анимация фильтров
- Структура компонентов
- Логика renderDepth (только значение таймера)

## Результат

При zoom-out дочерние элементы мягко растворяются за 150мс, не пытаясь одновременно сжаться — убирается эффект "схлопывания в точку". Переход выглядит как: дети исчезли -> родитель плавно занял новый размер.
